<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<title>Image files</title>
<link href="tutor.css" title="Tutor Style" type="text/css" rel="stylesheet" />
<link href="tutor_bw.css" title="Black and white" type="text/css" rel="stylesheet" />
</head>
<body>
<div id="topbar">
<img alt="" src="maths.gif" class="titleimage"/>
<span class="title">Playing with images</span>
</div>
<div id="navbar">
<span class="heading">Crunchy user tutorial</span>
<a href="welcome_en.html">Begin tutorial</a>
<a href="interpreter_en.html">Interpreter</a>
<a href="editor_en.html">Editor</a>
<a href="doctest_en.html">DocTest</a>
<a href="canvas_en.html">Graphics</a>
<a href="images_en.html">Image files</a>
<a href="external_en.html">External applications</a>
<span class="heading">Advanced Topics</span>
<a href="remote_en.html">Browsing</a>
<a href="config_en.html">Configuring Crunchy</a>
<a href="faq_en.html">FAQ, bugs, etc.</a>
<a href="writing_en.html">Writing tutorials</a>
<a href="/functional_tests">Tests</a>
</div>
<div id="main">
<h3 class="crunchy">Dynamically inserting images into a page</h3>
<p>Crunchy allow a user to insert one or more images interactively below
an interpreter or any other elements.  The technique used to do this kind of
web page transformation is known as <i>dynamic html</i> or <i>dhtml</i> for short.
You need to import the <code>dhtml.py</code> module to do this within
Crunchy.
</p>
<pre title="interpreter">
import dhtml
dhtml.image("../crunchy-python-powered.png", width=457, height=83)
</pre
<p>
The above image has been loaded from a location given relative to the current 
html file being displayed, always assumed to be from the basic server.  
To load other images, you will need to specify the absolute path.  Since
I do not know the path of interesting images on your computer, 
I'll give you another one to try.
</p>
<pre title="interpreter">
dhtml.image("http://imgs.xkcd.com/comics/python.png")
</pre>
<p>
By default, Crunchy displays images with a width and height of 400 pixels each.
As you have seen in the first example, you can specify other parameters for
the image.
</p>
<p>Crunchy can also work with modules that generate images 
to display them dynamically within the browser.  To
help you with locating images, Crunchy defines two
locations on your computer: your home directory and the Crunchy temporary
directory.

The following example
assumes that matplotlib is installed; if it's not, you're out of luck!</p>
<pre title="editor">
import dhtml
image_file = dhtml.join_path(dhtml.home, "foo.png")

# assumes matplotlib is installed
import matplotlib.numerix as nx
import pylab

def boltzman(x, xmid, tau):
    """
    evaluate the boltzman function with midpoint 
    xmid and time constant tau over x
    """
    return 1. / (1. + nx.exp(-(x-xmid)/tau))

def fill_below_intersection(x, S, Z):
    """
    fill the region below the intersection of S and Z
    """
    #find the intersection point
    ind = nx.nonzero( nx.absolute(S-Z)==min(nx.absolute(S-Z)))[0]
    # compute a new curve which we will fill below
    Y = nx.zeros(S.shape, typecode=nx.Float)
    Y[:ind] = S[:ind]  # Y is S up to the intersection
    Y[ind:] = Z[ind:]  # and Z beyond it
    pylab.fill(x, Y, facecolor='blue', alpha=0.5)

x = nx.arange(-6, 6, .01)
S = boltzman(x, 0, 1)
Z = 1-boltzman(x, 0.5, 1)
pylab.plot(x, S, x, Z, color='red', lw=2)
fill_below_intersection(x, S, Z)

pylab.savefig(image_file)
dhtml.image(image_file)
</pre>
<div class="notes">
<h4>Suggestions?</h4>
<p> If you have some suggestions for libraries other than matplotlib that generate
images and could be showcased by Crunchy, let us know.
</p>
</div>

<h3 class="crunchy">Advanced dhtml</h3>
<p>More to write</p>
</div>

</body>
</html>