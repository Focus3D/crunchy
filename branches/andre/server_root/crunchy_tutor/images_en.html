<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<title>Image files</title>
<link href="tutor.css" title="Tutor Style" type="text/css" rel="stylesheet" />
<link href="tutor_bw.css" title="Black and white"type="text/css" rel="stylesheet" />
</head>
<body>
<div id="topbar">
<img alt="" src="maths.gif" class="titleimage"/>
<span class="title">Playing with images</span>
</div>
<div id="navbar">
<span class="heading">Crunchy user tutorial</span>
<a href="welcome_en.html">Begin tutorial</a>
<a href="interpreter_en.html">Interpreter</a>
<a href="editor_en.html">Editor</a>
<a href="doctest_en.html">DocTest</a>
<a href="canvas_en.html">Graphics</a>
<a href="images_en.html">Image files</a>
<a href="external_en.html">External applications</a>
<span class="heading">Advanced Topics</span>
<a href="remote_en.html">Browsing</a>
<a href="config_en.html">Configuring Crunchy</a>
<a href="writing_en.html">Writing tutorials</a>
<a href="/functional_tests">Tests</a>
</div>
<div id="main">
<div class="notes">
<h4>Bug?</h4>
<p> Sometimes (always?) the image generated is not displayed properly after you click
on the obvious button.  This is why we have provided a second button to (re)load the
image.
</p>
</div>
<p>Crunchy can now work with modules that generate images to display them dynamically
within the browser.  The following example
assumes that matplotlib is installed; if it's not, you're out of luck!</p>
<pre title="image_file foo.png">
# assumes matplotlib is installed
import matplotlib.numerix as nx
import pylab as p

def boltzman(x, xmid, tau):
    """
    evaluate the boltzman function with midpoint 
    xmid and time constant tau over x
    """
    return 1. / (1. + nx.exp(-(x-xmid)/tau))

def fill_below_intersection(x, S, Z):
    """
    fill the region below the intersection of S and Z
    """
    #find the intersection point
    ind = nx.nonzero( nx.absolute(S-Z)==min(nx.absolute(S-Z)))[0]
    # compute a new curve which we will fill below
    Y = nx.zeros(S.shape, typecode=nx.Float)
    Y[:ind] = S[:ind]  # Y is S up to the intersection
    Y[ind:] = Z[ind:]  # and Z beyond it
    p.fill(x, Y, facecolor='blue', alpha=0.5)

x = nx.arange(-6, 6, .01)
S = boltzman(x, 0, 1)
Z = 1-boltzman(x, 0.5, 1)
p.plot(x, S, x, Z, color='red', lw=2)
fill_below_intersection(x, S, Z)
p.savefig("foo.png")
</pre>
<div class="notes">
<h4>Suggestions?</h4>
<p> If you have some suggestions for libraries other than matplotlib that generate
images and could be showcased by Crunchy, let us know.
</p>
</div>

<h3>Advanced stuff, for tutorial writers</h3>
<p>The required markup is as follows.</p>
<pre title="no_vlam">
&lt;pre title="image_file filename [no-copy] [no-pre] 
                                   [linenumber [=start_number]]"&gt;
Some Python code
&lt;/pre&gt;</pre>
<p>Note that the filename must be included, otherwise the code will simply be styled.
The Python code that is to be executed <b>must</b> save a file under the same name 
(the file will be saved in a temporary directory maintained by Crunchy).</p>
</div>

</body>
</html>